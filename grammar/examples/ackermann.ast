PROGRAM
  IMPORTS
    IMPORT
      MODULE
        MODULE_COMPONENT: std
        MODULE_COMPONENT: satie
    IMPORT
      MODULE
        MODULE_COMPONENT: std
        MODULE_COMPONENT: jobs
      IMPORTED_NAMES
        IMPORTED_NAME: JobStatus
        IMPORTED_NAME: SpawnOption
    IMPORT
      MODULE
        MODULE_COMPONENT: std
        MODULE_COMPONENT: channels
      IMPORTED_NAMES
        IMPORTED_NAME: ChannelOption
    IMPORT
      MODULE
        MODULE_COMPONENT: std
        MODULE_COMPONENT: stdio
  TOP_LEVEL_DEFS
    FUNCTION_DEF
      EXPORT
      FUNCTION_NAME: main
      BLOCK_EXPR
        BIND
          UNBOUND_NAME: ackermann
          NEW_EXPR
            NAME: Ackermann
        BIND
          UNBOUND_NAME: ackermann
          POSTFIX_EXPR
            BOUND_NAME: ackermann
            DOT_NAME: startJobs
            FUNCTION_CALL
              POSITIONAL_ARGS
                INTEGRAL: 3
                INTEGRAL: 10
        POSTFIX_EXPR
          BOUND_NAME: ackermann
          DOT_NAME: waitForJobs
          FUNCTION_CALL
    CLASS_DEF
      CLASS_NAME: Ackermann
      CLASS_MEMBERS
        MEMBER_PROPERTY
          PRIVATE
          NAME: jobs
          LIST_LITERAL
        MEMBER_PROPERTY
          PRIVATE
          NAME: resultChannel
        CONSTRUCTOR
          BLOCK_EXPR
            POSTFIX_EXPR
              THIS
              FUNCTION_CALL
                NAMED_ARGS
                  NAMED_ARG
                    NAME: resultChannel
                    POSTFIX_EXPR
                      BOUND_NAME: satie
                      DOT_NAME: makeChannel
                      FUNCTION_CALL
                        NAMED_ARGS
                          NAMED_ARG
                            NAME: onCrowding
                            TUPLE_LITERAL
                              ENUM_LITERAL
                                ENUM_DEF_NAME: ChannelOption
                                ENUM_NAME: block
                              INTEGRAL: 4
        MEMBER_METHOD
          PUBLIC
          FUNCTION_DEF
            FUNCTION_NAME: startJobs
            PARAMS
              NON_DEFAULT_PARAMS
                NON_DEFAULT_PARAM: m
                NON_DEFAULT_PARAM: n
              DEFAULT_PARAMS
                DEFAULT_PARAM
                  DEFAULT_PARAM_NAME: i
                  INTEGRAL: 0
                DEFAULT_PARAM
                  DEFAULT_PARAM_NAME: startedJobs
                  LIST_LITERAL
            BLOCK_EXPR
              IF_EXPR
                IF
                  LT
                    BOUND_NAME: i
                    BOUND_NAME: n
                  BLOCK_EXPR
                    FUNCTION_DEF
                      FUNCTION_NAME: computeAckermann
                      NON_DEFAULT_PARAMS
                        NON_DEFAULT_PARAM: m
                        NON_DEFAULT_PARAM: n
                      BLOCK_EXPR
                        BIND
                          UNBOUND_NAME: result
                          POSTFIX_EXPR
                            BOUND_NAME: ackermann
                            FUNCTION_CALL
                              POSITIONAL_ARGS
                                BOUND_NAME: m
                                BOUND_NAME: n
                        POSTFIX_EXPR
                          BOUND_NAME: resultChannel
                          DOT_NAME: send
                          FUNCTION_CALL
                            POSITIONAL_ARGS
                              TUPLE_LITERAL
                                SELF
                                BOUND_NAME: m
                                BOUND_NAME: n
                                BOUND_NAME: result
                    BIND
                      UNBOUND_NAME: job
                      POSTFIX_EXPR
                        BOUND_NAME: satie
                        DOT_NAME: spawn
                        FUNCTION_CALL
                          POSITIONAL_ARGS
                            FUNCTION_LITERAL
                              BLOCK_EXPR
                                POSTFIX_EXPR
                                  BOUND_NAME: computeAckermann
                                  FUNCTION_CALL
                                    POSITIONAL_ARGS
                                      BOUND_NAME: m
                                      BOUND_NAME: i
                            MAP_LITERAL
                              MAP_KEY_VALUE
                                ENUM_LITERAL
                                  ENUM_DEF_NAME: SpawnOption
                                  ENUM_NAME: monitor
                                TRUE
                    POSTFIX_EXPR
                      BOUND_NAME: startJobs
                      FUNCTION_CALL
                        POSITIONAL_ARGS
                          BOUND_NAME: m
                          BOUND_NAME: n
                          PLUS
                            BOUND_NAME: i
                            INTEGRAL: 1
                          CONCAT
                            BOUND_NAME: job
                            BOUND_NAME: startedJobs
                ELSE
                  BLOCK_EXPR
                    POSTFIX_EXPR
                      THIS
                      FUNCTION_CALL
                        NAMED_ARGS
                          NAMED_ARG
                            NAME: jobs
                            BOUND_NAME: startedJobs
        MEMBER_METHOD
          PUBLIC
          FUNCTION_DEF
            FUNCTION_NAME: waitForJobs
            BLOCK_EXPR
              FUNCTION_DEF
                FUNCTION_NAME: waitForJobs
                NON_DEFAULT_PARAMS
                  NON_DEFAULT_PARAM: jobs
                BLOCK_EXPR
                  IF_EXPR
                    IF
                      GT
                        POSTFIX_EXPR
                          BOUND_NAME: jobs
                          DOT_NAME: length
                        INTEGRAL: 0
                      BLOCK_EXPR
                        RECEIVE_EXPR
                          RECEIVE
                            CHANNELS
                              CHANNEL
                                CHANNEL_NAME: systemChannel
                              CHANNEL
                                CHANNEL_NAME: satie
                                DOT_NAME: systemChannel
                          CASE
                            MATCH_EXPRS
                              TUPLE_LITERAL
                                UNBOUND_NAME: job
                                UNBOUND_NAME: m
                                UNBOUND_NAME: n
                                UNBOUND_NAME: result
                            BLOCK_EXPR
                              POSTFIX_EXPR
                                BOUND_NAME: stdio
                                DOT_NAME: writeln
                                FUNCTION_CALL
                                  POSITIONAL_ARGS
                                    REGULAR_STRING: ackermann($m, $n) = $result
                              POSTFIX_EXPR
                                BOUND_NAME: waitForJobs
                                FUNCTION_CALL
                                  POSITIONAL_ARGS
                                    POSTFIX_EXPR
                                      BOUND_NAME: jobs
                                      DOT_NAME: delete
                                      FUNCTION_CALL
                                        POSITIONAL_ARGS
                                          BOUND_NAME: job
                          CASE
                            MATCH_EXPRS
                              TUPLE_LITERAL
                                ENUM_LITERAL
                                  ENUM_DEF_NAME: JobStatus
                                  ENUM_NAME: died
                                UNBOUND_NAME: job
                                UNBOUND_NAME: reason
                            BLOCK_EXPR
                              POSTFIX_EXPR
                                BOUND_NAME: stdio
                                DOT_NAME: writeln
                                FUNCTION_CALL
                                  POSITIONAL_ARGS
                                    REGULAR_STRING: Oh no! Compute job $job died: $reason
                              POSTFIX_EXPR
                                BOUND_NAME: waitForJobs
                                FUNCTION_CALL
                                  POSITIONAL_ARGS
                                    POSTFIX_EXPR
                                      BOUND_NAME: jobs
                                      DOT_NAME: delete
                                      FUNCTION_CALL
                                        POSITIONAL_ARGS
                                          BOUND_NAME: job
                    ELSE
                      BLOCK_EXPR
                        POSTFIX_EXPR
                          THIS
                          FUNCTION_CALL
                            NAMED_ARGS
                              NAMED_ARG
                                NAME: jobs
                                LIST_LITERAL
              POSTFIX_EXPR
                BOUND_NAME: waitForJobs
                FUNCTION_CALL
                  POSITIONAL_ARGS
                    BOUND_NAME: jobs
        MEMBER_METHOD
          PRIVATE
          FUNCTION_DEF
            FUNCTION_NAME: ackermann
            NON_DEFAULT_PARAMS
              NON_DEFAULT_PARAM: m
              NON_DEFAULT_PARAM: n
            BLOCK_EXPR
              IF_EXPR
                IF
                  EQ
                    BOUND_NAME: m
                    INTEGRAL: 0
                  BLOCK_EXPR
                    PLUS
                      BOUND_NAME: n
                      INTEGRAL: 1
                ELIF
                  EQ
                    BOUND_NAME: n
                    INTEGRAL: 0
                  BLOCK_EXPR
                    POSTFIX_EXPR
                      BOUND_NAME: ackermann
                      FUNCTION_CALL
                        POSITIONAL_ARGS
                          MINUS
                            BOUND_NAME: m
                            INTEGRAL: 1
                          INTEGRAL: 1
                ELSE
                  BLOCK_EXPR
                    POSTFIX_EXPR
                      BOUND_NAME: ackermann
                      FUNCTION_CALL
                        POSITIONAL_ARGS
                          MINUS
                            BOUND_NAME: m
                            INTEGRAL: 1
                          POSTFIX_EXPR
                            BOUND_NAME: ackermann
                            FUNCTION_CALL
                              POSITIONAL_ARGS
                                BOUND_NAME: m
                                MINUS
                                  BOUND_NAME: n
                                  INTEGRAL: 1
